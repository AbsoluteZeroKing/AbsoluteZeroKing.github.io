(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{509:function(t,s,a){"use strict";a.r(s);var n=a(19),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"强化学习价值迭代与桥畅通"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#强化学习价值迭代与桥畅通"}},[t._v("#")]),t._v(" 强化学习价值迭代与桥畅通")]),t._v(" "),a("blockquote",[a("p",[t._v("题目链接：https://inst.eecs.berkeley.edu//~cs188/sp20/project3/")])]),t._v(" "),a("h2",{attrs:{id:"q1-value-iteration"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#q1-value-iteration"}},[t._v("#")]),t._v(" Q1:Value Iteration")]),t._v(" "),a("p",[t._v("第一题实际上就是要我们使用强化学习中的价值迭代法来更新完成整个矩阵的权值，由于我课上听的其实不是很懂，所以需要课下再学习一下价值迭代法：")]),t._v(" "),a("p",[t._v("首先我们已经在课上知道了马尔科夫决策的过程（MDP），总结起来就是三个部分：")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("状态空间State")]),t._v("（S）")]),t._v(" "),a("li",[a("strong",[t._v("决策空间Action")]),t._v("(A)")]),t._v(" "),a("li",[a("strong",[t._v("Action对State的影响和回报P")]),t._v("(State', Reward | State, Action)")])]),t._v(" "),a("p",[t._v("其实比较关键的就是最后的P值如何计算，针对这一题每一轮的计算其实都是分成以下几个步骤")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("对于每个state，逐一尝试上、下、左、右四个Action")])]),t._v(" "),a("li",[a("ul",[a("li",[t._v("记录Action带来的Reward、以及新状态 V(s')")]),t._v(" "),a("li",[t._v("选择最优的Action，保存V(s) = Reward + V(s') （不是立刻更新）")])])])]),t._v(" "),a("p",[t._v("这里有两个关键点容易搞错，也是价值迭代的关键所在")]),t._v(" "),a("ul",[a("li",[t._v("每一次的state迭代只在整个迭代完成后统一更新每一个state的value值，即做到当前state的计算只跟上一轮的状态有关，而不会因为本轮的计算而被影响")]),t._v(" "),a("li",[t._v("state所拿到的Reward并不是走到以后拿到，而是在自己在当前位置时再走一步的时候拿到，这也是老师上课时讲的奖励滞后")])]),t._v(" "),a("p",[t._v("最后套上价值迭代的公式即可\n$$\nV_{"),a("em",[t._v("}(s)=\\max "),a("em",[t._v("{a} \\sum")]),t._v("{s^{\\prime}, r} p\\left(s^{\\prime}, r \\mid s, a\\right)\\left[r+\\gamma V_{")]),t._v("}\\left(s^{\\prime}\\right)\\right]\n$$")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ValueIterationAgent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ValueEstimationAgent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[t._v('"""\n        * Please read learningAgents.py before reading this.*\n\n        A ValueIterationAgent takes a Markov decision process\n        (see mdp.py) on initialization and runs value iteration\n        for a given number of iterations using the supplied\n        discount factor.\n    """')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("__init__")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" mdp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" discount "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.9")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" iterations "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[t._v('"""\n          Your value iteration agent should take an mdp on\n          construction, run the indicated number of iterations\n          and then act according to the resulting policy.\n\n          Some useful mdp methods you will use:\n              mdp.getStates()\n              mdp.getPossibleActions(state)\n              mdp.getTransitionStatesAndProbs(state, action)\n              mdp.getReward(state, action, nextState)\n              mdp.isTerminal(state)\n        """')]),t._v("\n        self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mdp "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" mdp\n        self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("discount "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" discount\n        self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("iterations "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" iterations\n        self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("values "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" util"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Counter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# A Counter is a dict with default 0")]),t._v("\n        self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("runValueIteration"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("runValueIteration")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Write value iteration code here")]),t._v("\n        next_values "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("values"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("copy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" iter_nums "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("range")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("iterations"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" state "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mdp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("getStates"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mdp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("isTerminal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("continue")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#从上下左右的可能行动中找到Qvalue最大的一次")]),t._v("\n                next_values"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("max")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("getQValue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" action"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                                          "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" action "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mdp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("getPossibleActions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("values "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" next_values"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("copy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getValue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[t._v('"""\n          Return the value of the state (computed in __init__).\n        """')]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("values"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("computeQValueFromValues")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" action"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[t._v('"""\n          Compute the Q-value of action in state from the\n          value function stored in self.values.\n        """')]),t._v("\n        successors "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mdp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("getTransitionStatesAndProbs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" action"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        qval "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" next_state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" prob "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" successors"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#根据公式计算q值")]),t._v("\n            qval "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" prob "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mdp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("getReward"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" action"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" next_state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("discount "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("getValue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("next_state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" qval\n        util"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("raiseNotDefined"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("computeActionFromValues")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[t._v('"""\n          The policy is the best action in the given state\n          according to the values currently stored in self.values.\n\n          You may break ties any way you see fit.  Note that if\n          there are no legal actions, which is the case at the\n          terminal state, you should return None.\n        """')]),t._v("\n        policy "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" util"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Counter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#从上下左右中可能的行动中获取在policy下的Q值，并使用封装好的argMax返回Q值最大的结果")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" action "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mdp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("getPossibleActions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            policy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("action"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("getQValue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("  action"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" policy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("argMax"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        util"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("raiseNotDefined"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getPolicy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("computeActionFromValues"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getAction")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Returns the policy at the state (no exploration)."')]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("computeActionFromValues"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getQValue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" action"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("computeQValueFromValues"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" action"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("执行")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("python autograder.py -q q1\n")])])]),a("p",[a("img",{attrs:{src:"https://image.leesdog.space/ai410.png",alt:"image-20210608202851742"}})]),t._v(" "),a("p",[t._v("执行")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("python gridworld.py -a value -i 100 -k 10\n")])])]),a("p",[a("img",{attrs:{src:"https://image.leesdog.space/ai402.png",alt:"image-20210608201112641"}})]),t._v(" "),a("p",[a("img",{attrs:{src:"https://image.leesdog.space/ai403.png",alt:"image-20210608201245588"}})]),t._v(" "),a("p",[t._v("执行")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("python gridworld.py -a value -i 5\n")])])]),a("p",[a("img",{attrs:{src:"https://image.leesdog.space/ai407.png",alt:"image-20210608201344698"}})]),t._v(" "),a("p",[a("img",{attrs:{src:"https://image.leesdog.space/ai406.png",alt:"image-20210608201327905"}})]),t._v(" "),a("h2",{attrs:{id:"q2-bridge-crossing-analysis"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#q2-bridge-crossing-analysis"}},[t._v("#")]),t._v(" Q2 Bridge Crossing Analysis")]),t._v(" "),a("p",[t._v("第二题其实就是让我们通过这样一个桥梁测试，同时只让我们改noise和discount中的一个参数；")]),t._v(" "),a("p",[a("strong",[t._v("noise")]),t._v("就是其决策时的噪声，该值越大其决策的随机性越高；")]),t._v(" "),a("p",[a("strong",[t._v("discount")]),t._v("其实就是γ，也就是每走一步所乘的权值")]),t._v(" "),a("p",[t._v("要通过该测试，其实分析一下题目的情况就可以了")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://image.leesdog.space/ai408.png",alt:"image-20210608202343748"}})]),t._v(" "),a("p",[t._v("可以看到我们希望他向右一直走，而不要向上下偏移，在这种情况下其实就是起点到终点"),a("strong",[t._v("走路径最短的一条路")]),t._v("；要让程序如此行动，其实可以有两种方式，一种方式是将discount调整到使得正值偏大的一个地方，即使得下面式子整体偏大；还有一种方式是将noise调小，这样使得偏向走-100的概率变小，其实也是将整体Q值调大，这里将answerNoise调成0.001即可通过测试\n$$\nR_{t+1}+\\gamma R_{t+2}+\\gamma^{2} R_{t+3}+\\gamma^{3} R_{t+4}+\\ldots\n$$\n"),a("img",{attrs:{src:"https://image.leesdog.space/ai412.png",alt:"image-20210608204123625"}})]),t._v(" "),a("h2",{attrs:{id:"q3-policies"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#q3-policies"}},[t._v("#")]),t._v(" Q3:Policies")]),t._v(" "),a("p",[t._v("这一题的情况如下")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://image.leesdog.space/AI415.png",alt:"image-20210608204416040"}})]),t._v(" "),a("p",[t._v("他需要我们调整参数以完成以下5个策略：")]),t._v(" "),a("ol",[a("li",[t._v("更喜欢关闭退出（+1），冒着悬崖的风险（-10）")]),t._v(" "),a("li",[t._v("更喜欢关闭退出（+1），但要避开悬崖（-10）")]),t._v(" "),a("li",[t._v("偏爱远处出口（+10），冒着悬崖（-10）")]),t._v(" "),a("li",[t._v("喜欢远处的出口（+10），避开悬崖（-10）")]),t._v(" "),a("li",[t._v("避免出口和悬崖（因此一集永远不应该终止）")])]),t._v(" "),a("p",[t._v("其实要完成这些结果，核心点在于去根据公式计算其最终的value是否是导致其朝着既定的方向走即可，只要首先把握一个大的方向即可：")]),t._v(" "),a("p",[t._v("当更喜欢冒着悬崖的风险的时候此时走的路径较短，所以我们应该加大每走一步的惩罚Reward；")]),t._v(" "),a("p",[t._v("当更喜欢远处出口的时候，可以加大每走一步的奖励Reward使其更愿意走向较远的出口；")]),t._v(" "),a("p",[t._v("同时noise其实都可以调到很小（甚至调成0也行）使其更愿意执行你所设定的方向")]),t._v(" "),a("p",[t._v("然后随便调一调就可以了")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("question3a")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    answerDiscount "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.01")]),t._v("\n    answerNoise "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n    answerLivingReward "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" answerDiscount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" answerNoise"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" answerLivingReward\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# If not possible, return 'NOT POSSIBLE'")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("question3b")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    answerDiscount "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.01")]),t._v("\n    answerNoise "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.01")]),t._v("\n    answerLivingReward "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.5")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" answerDiscount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" answerNoise"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" answerLivingReward\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# If not possible, return 'NOT POSSIBLE'")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("question3c")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    answerDiscount "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.9")]),t._v("\n    answerNoise "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n    answerLivingReward "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" answerDiscount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" answerNoise"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" answerLivingReward\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# If not possible, return 'NOT POSSIBLE'")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("question3d")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    answerDiscount "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.9")]),t._v("\n    answerNoise "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.2")]),t._v("\n    answerLivingReward "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" answerDiscount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" answerNoise"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" answerLivingReward\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# If not possible, return 'NOT POSSIBLE'")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("question3e")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    answerDiscount "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n    answerNoise "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.1")]),t._v("\n    answerLivingReward "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" answerDiscount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" answerNoise"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" answerLivingReward\n")])])]),a("p",[t._v("最终结果：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://image.leesdog.space/ai420.png",alt:"image-20210608204622649"}})])])}),[],!1,null,null,null);s.default=e.exports}}]);